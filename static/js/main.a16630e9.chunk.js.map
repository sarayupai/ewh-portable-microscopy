{"version":3,"sources":["components/AlertDismissable.js","pages/About.js","components/LoadButton.js","model/classes.js","config.js","pages/Classify.js","pages/Instructions.js","pages/NotFound.js","Routes.js","App.js","serviceWorker.js","index.js"],"names":["AlertDismissable","this","props","show","Alert","variant","onClose","dismissible","title","dangerouslySetInnerHTML","__html","message","Component","Home","className","href","isLoading","text","loadingText","disabled","Button","Spinner","as","animation","size","role","aria-hidden","MODEL_CLASSES","0","1","2","3","4","5","MODEL_PATH","IMAGE_SIZE","CANVAS_SIZE","INDEXEDDB_STORE","INDEXEDDB_KEY","Classify","initWebcam","a","tf","webcam","refs","resizeWidth","resizeHeight","facingMode","noWebcam","style","display","startWebcam","start","stopWebcam","stop","getModelInfo","fetch","config","method","then","response","json","data","modelLastUpdated","last_updated","catch","err","console","log","updateModel","setState","isDownloadingModel","model","save","modelUpdateAvailable","showModelUpdateAlert","showModelUpdateSuccess","classifyLocalImage","isClassifying","croppedCanvas","cropper","getCroppedCanvas","image","fromPixels","toFloat","processImage","imageData","resizedImage","resizeBilinear","logits","predict","probabilities","getTopKClasses","preds","predictions","photoSettingsOpen","state","dispose","classifyWebcamImage","capture","imageCapture","resized","tensorData","div","toPixels","canvas","expandDims","values","topK","topClassesAndProbs","length","valuesAndIndices","i","push","value","index","sort","b","topkValues","Float32Array","topkIndices","Int32Array","probability","toFixed","prediction","idx","handlePanelClick","event","handleFileChange","target","files","file","URL","createObjectURL","filename","name","handleTabSelect","activeKey","modelLoaded","isModelLoading","window","openDB","db","transaction","objectStore","get","item","dateSaved","Date","modelArtifactsInfo","getTime","warn","e","onClick","aria-controls","aria-expanded","Collapse","in","id","Container","modelType","Tabs","defaultActiveKey","onSelect","Tab","eventKey","ref","autoPlay","playsInline","muted","width","height","LoadButton","Form","Group","controlId","Label","Control","onChange","type","accept","src","guides","aspectRatio","viewMode","ListGroup","map","category","Item","childProps","path","exact","component","Instructions","About","NotFound","App","dismissUpdateAlert","showUpdateAlert","reloadMsg","Navbar","collapseOnSelect","expand","Brand","Toggle","Nav","to","updateAvailable","paddingTop","Routes","withRouter","isLocalhost","Boolean","location","hostname","match","register","navigator","process","origin","addEventListener","swUrl","contentType","headers","status","indexOf","serviceWorker","ready","registration","unregister","reload","registerValidSW","checkValidServiceWorker","newerSwAvailable","sw","onUpdate","waiting","active","onupdatefound","installingWorker","installing","onstatechange","controller","onSuccess","error","Index","contentCached","handleUpdate","waitingServiceWorker","postMessage","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.a16630e9.chunk.js","sourcesContent":["\r\nimport React, { Component } from 'react';\r\nimport { Alert } from 'react-bootstrap';\r\n\r\n/**\r\n * Class to handle the rendering of a dismissiable alert to use for things like errors.\r\n * @extends React.Component\r\n */\r\nclass AlertDismissable extends Component {\r\n\r\n  render() {\r\n    if (this.props.show) {\r\n      return (\r\n        <Alert variant={this.props.variant || 'danger'} onClose={this.props.onClose} dismissible>\r\n          { this.props.title && <h5><strong>{this.props.title}</strong></h5> }\r\n          <div dangerouslySetInnerHTML={{ __html: this.props.message }} />\r\n        </Alert>\r\n      );\r\n    }\r\n    return null;\r\n  }\r\n}\r\n\r\nexport default AlertDismissable;\r\n","import React, { Component } from 'react';\r\nimport './About.css';\r\n\r\n/**\r\n * Class to handle the rendering of the Home page.\r\n * @extends React.Component\r\n */\r\nexport default class Home extends Component {\r\n  render() {\r\n    return (\r\n      <div className=\"About container\">\r\n        <h1>About</h1>\r\n        <p>\r\n          <b>\r\n            Our Product\r\n          </b>\r\n        </p>\r\n        <p>\r\n          EWH Portable Microscopy Software for Parasitic Infection Diagnosis\r\n          This is a TensorFlow.js web application where users can classify images selected locally\r\n          or taken with their device's camera. The app uses TensorFlow.js and a pre-trained model\r\n          converted to the TensorFlow.js format to provide the inference capabilities.\r\n          This model is saved locally in the browser using IndexedDB. A service worker is also used\r\n          to provide offline capabilities.\r\n        <br />\r\n        <br />\r\n          The Portable Microscopy team of Engineering World Health (EWH) UCSD\r\n          Chapter 2020-2021 developed and trained a convolutional neural network\r\n          to identify soil transmitted helminths in fecal samples. Soil\r\n          transmitted helminth infections affect nearly 1 billion people globally,\r\n          and are typically treated through mass drug administration without\r\n          diagnosis. Through this webpage, you can upload images of fecal samples\r\n          and our network will check for Soil Transmitted Helminths and output a\r\n          diagnosis.\r\n        <br />\r\n        <br />\r\n        </p>\r\n        <p>\r\n        <b>\r\n          Our Team\r\n        </b>\r\n        </p>\r\n        <p>\r\n          The Portable Microscopy team of Engineering World Health (EWH) UCSD Chapter 2020-2021\r\n        </p>\r\n        <h1>Contact Us for Suggestions</h1>\r\n        <p>\r\n        If you’d like to contact us for any clarifications, questions, or\r\n        suggestions to this webpage and/or convolutional neural network, please\r\n        contact us at\r\n        <br />\r\n        - rkunowsk@ucsd.edu\r\n        <br />\r\n        - s2pai@ucsd.edu\r\n        <br />\r\n        Or fill out this google form:\r\n        <a href=\"//forms.gle/5vp3nQWbFB64kzQR9\"> Google Form for Suggestions or Questions</a>\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React from 'react';\r\nimport { Button, Spinner } from 'react-bootstrap';\r\n\r\n/**\r\n * This produces a button that will have a loading animation while the isLoading property is true.\r\n */\r\nexport default ({\r\n  isLoading,\r\n  text,\r\n  loadingText,\r\n  className = '',\r\n  disabled = false,\r\n  ...props\r\n}) =>\r\n  <Button\r\n    className={`LoadButton ${className}`}\r\n    disabled={disabled || isLoading}\r\n    {...props}\r\n  >\r\n    {isLoading && <Spinner\r\n      as=\"span\"\r\n      animation=\"border\"\r\n      size=\"sm\"\r\n      role=\"status\"\r\n      aria-hidden=\"true\"\r\n    />}{' '}\r\n    {isLoading ? loadingText : text}\r\n  </Button>;\r\n","/* eslint-disable */\r\n// Theses classes should correspond to the softmax output of your model.\r\n\r\nexport const MODEL_CLASSES = {\r\n  0: 'Negative for STH',\r\n  1: 'Hookwork',\r\n  2: 'Ascaris',\r\n  3: 'Trichuris',\r\n  4: 'Positive for STH',\r\n  5: 'Inconclusive: Please run again'\r\n};\r\n","export default {\r\n  API_ENDPOINT: 'https://sarayupai.github.io/ewh-portable-microscopy/api'\r\n  //API_ENDPOINT: 'http://localhost:3000/ewh-portable-microscopy/api',\r\n};\r\n","import React, { Component, Fragment } from 'react';\r\nimport {\r\n  Alert, Button, Collapse, Container, Form, Spinner, ListGroup, Tabs, Tab\r\n} from 'react-bootstrap';\r\nimport { FaCamera, FaChevronDown, FaChevronRight } from 'react-icons/fa';\r\nimport { openDB } from 'idb';\r\nimport Cropper  from 'react-cropper';\r\nimport * as tf from '@tensorflow/tfjs';\r\nimport LoadButton from '../components/LoadButton';\r\nimport { MODEL_CLASSES } from '../model/classes';\r\nimport config from '../config';\r\nimport './Classify.css';\r\nimport 'cropperjs/dist/cropper.css';\r\n\r\n\r\nconst MODEL_PATH = '/ewh-portable-microscopy/model/model.json';\r\nconst IMAGE_SIZE = 100;\r\nconst CANVAS_SIZE = 224;\r\nconst TOPK_PREDICTIONS = 1;\r\n\r\nconst INDEXEDDB_DB = 'tensorflowjs';\r\nconst INDEXEDDB_STORE = 'model_info_store';\r\nconst INDEXEDDB_KEY = 'web-model';\r\n\r\n/**\r\n * Class to handle the rendering of the Classify page.\r\n * @extends React.Component\r\n */\r\nexport default class Classify extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.webcam = null;\r\n    this.model = null;\r\n    this.modelLastUpdated = null;\r\n\r\n    this.state = {\r\n      modelLoaded: false,\r\n      filename: '',\r\n      isModelLoading: false,\r\n      isClassifying: false,\r\n      predictions: [],\r\n      photoSettingsOpen: true,\r\n      modelUpdateAvailable: false,\r\n      showModelUpdateAlert: false,\r\n      showModelUpdateSuccess: false,\r\n      isDownloadingModel: false\r\n    };\r\n  }\r\n\r\n  async componentDidMount() {\r\n    if (('indexedDB' in window)) {\r\n      try {\r\n        this.model = await tf.loadLayersModel('indexeddb://' + INDEXEDDB_KEY);\r\n\r\n        // Safe to assume tensorflowjs database and related object store exists.\r\n        // Get the date when the model was saved.\r\n        try {\r\n          const db = await openDB(INDEXEDDB_DB, 1, );\r\n          const item = await db.transaction(INDEXEDDB_STORE)\r\n                               .objectStore(INDEXEDDB_STORE)\r\n                               .get(INDEXEDDB_KEY);\r\n          const dateSaved = new Date(item.modelArtifactsInfo.dateSaved);\r\n          await this.getModelInfo();\r\n          console.log(this.modelLastUpdated);\r\n          if (!this.modelLastUpdated  || dateSaved >= new Date(this.modelLastUpdated).getTime()) {\r\n            console.log('Using saved model');\r\n          }\r\n          else {\r\n            this.setState({\r\n              modelUpdateAvailable: true,\r\n              showModelUpdateAlert: true,\r\n            });\r\n          }\r\n\r\n        }\r\n        catch (error) {\r\n          console.warn(error);\r\n          console.warn('Could not retrieve when model was saved.');\r\n        }\r\n\r\n      }\r\n      // If error here, assume that the object store doesn't exist and the model currently isn't\r\n      // saved in IndexedDB.\r\n      catch (error) {\r\n        console.log('Not found in IndexedDB. Loading and saving...');\r\n        console.log(error);\r\n        this.model = await tf.loadLayersModel(MODEL_PATH);\r\n        await this.model.save('indexeddb://' + INDEXEDDB_KEY);\r\n      }\r\n    }\r\n    // If no IndexedDB, then just download like normal.\r\n    else {\r\n      console.warn('IndexedDB not supported.');\r\n      this.model = await tf.loadLayersModel(MODEL_PATH);\r\n    }\r\n\r\n    this.setState({ modelLoaded: true });\r\n    this.initWebcam();\r\n\r\n    // Warm up model.\r\n    let prediction = tf.tidy(() => this.model.predict(tf.zeros([1, IMAGE_SIZE, IMAGE_SIZE, 3])));\r\n    prediction.dispose();\r\n  }\r\n\r\n  async componentWillUnmount() {\r\n    if (this.webcam) {\r\n      this.webcam.stop();\r\n    }\r\n\r\n    // Attempt to dispose of the model.\r\n    try {\r\n      this.model.dispose();\r\n    }\r\n    catch (e) {\r\n      // Assume model is not loaded or already disposed.\r\n    }\r\n  }\r\n\r\n  initWebcam = async () => {\r\n    try {\r\n      this.webcam = await tf.data.webcam(\r\n        this.refs.webcam,\r\n        {resizeWidth: CANVAS_SIZE, resizeHeight: CANVAS_SIZE, facingMode: 'environment'}\r\n      );\r\n    }\r\n    catch (e) {\r\n      this.refs.noWebcam.style.display = 'block';\r\n    }\r\n  }\r\n\r\n  startWebcam = async () => {\r\n    if (this.webcam) {\r\n      this.webcam.start();\r\n    }\r\n  }\r\n\r\n  stopWebcam = async () => {\r\n    if (this.webcam) {\r\n      this.webcam.stop();\r\n    }\r\n  }\r\n\r\n  getModelInfo = async () => {\r\n    await fetch(`${config.API_ENDPOINT}/model_info`, {\r\n      method: 'GET',\r\n    })\r\n    .then(async (response) => {\r\n      await response.json().then((data) => {\r\n        this.modelLastUpdated = data.last_updated;\r\n      })\r\n      .catch((err) => {\r\n        console.log('Unable to get parse model info.');\r\n      });\r\n    })\r\n    .catch((err) => {\r\n      console.log('Unable to get model info');\r\n    });\r\n  }\r\n\r\n  updateModel = async () => {\r\n    // Get the latest model from the server and refresh the one saved in IndexedDB.\r\n    console.log('Updating the model: ' + INDEXEDDB_KEY);\r\n    this.setState({ isDownloadingModel: true });\r\n    this.model = await tf.loadLayersModel(MODEL_PATH);\r\n    await this.model.save('indexeddb://' + INDEXEDDB_KEY);\r\n    this.setState({\r\n      isDownloadingModel: false,\r\n      modelUpdateAvailable: false,\r\n      showModelUpdateAlert: false,\r\n      showModelUpdateSuccess: true\r\n    });\r\n  }\r\n\r\n  classifyLocalImage = async () => {\r\n    this.setState({ isClassifying: true });\r\n    console.log('Classifying local image');\r\n    const croppedCanvas = this.refs.cropper.getCroppedCanvas();\r\n    const image = tf.tidy( () => tf.browser.fromPixels(croppedCanvas).toFloat());\r\n\r\n    // Process and resize image before passing in to model.\r\n    const imageData = await this.processImage(image);\r\n    const resizedImage = tf.image.resizeBilinear(imageData, [IMAGE_SIZE, IMAGE_SIZE]);\r\n    //covert RBG\r\n\r\n    const logits = this.model.predict(resizedImage);\r\n    const probabilities = await logits.data();\r\n    const preds = await this.getTopKClasses(probabilities, TOPK_PREDICTIONS);\r\n\r\n    this.setState({\r\n      predictions: preds,\r\n      isClassifying: false,\r\n      photoSettingsOpen: !this.state.photoSettingsOpen\r\n    });\r\n\r\n    // Draw thumbnail to UI.\r\n    //const context = this.refs.canvas.getContext('2d');\r\n    //const ratioX = CANVAS_SIZE / croppedCanvas.width;\r\n    //const ratioY = CANVAS_SIZE / croppedCanvas.height;\r\n    //const ratio = Math.min(ratioX, ratioY);\r\n    //context.clearRect(0, 0, CANVAS_SIZE, CANVAS_SIZE);\r\n    //context.drawImage(croppedCanvas, 0, 0,\r\n    //                  croppedCanvas.width * ratio, croppedCanvas.height * ratio);\r\n\r\n    // Dispose of tensors we are finished with.\r\n    image.dispose();\r\n    imageData.dispose();\r\n    resizedImage.dispose();\r\n    logits.dispose();\r\n  }\r\n\r\n  classifyWebcamImage = async () => {\r\n    this.setState({ isClassifying: true });\r\n\r\n    const imageCapture = await this.webcam.capture();\r\n\r\n    const resized = tf.image.resizeBilinear(imageCapture, [IMAGE_SIZE, IMAGE_SIZE]);\r\n    const imageData = await this.processImage(resized);\r\n    //RGB\r\n    const logits = this.model.predict(imageData);\r\n    const probabilities = await logits.data();\r\n    const preds = await this.getTopKClasses(probabilities, TOPK_PREDICTIONS);\r\n\r\n    this.setState({\r\n      predictions: preds,\r\n      isClassifying: false,\r\n      photoSettingsOpen: !this.state.photoSettingsOpen\r\n    });\r\n\r\n    // Draw thumbnail to UI.\r\n    const tensorData = tf.tidy(() => imageCapture.toFloat().div(255));\r\n    await tf.browser.toPixels(tensorData, this.refs.canvas);\r\n\r\n    // Dispose of tensors we are finished with.\r\n    resized.dispose();\r\n    imageCapture.dispose();\r\n    imageData.dispose();\r\n    logits.dispose();\r\n    tensorData.dispose();\r\n  }\r\n\r\n  processImage = async (image) => {\r\n    console.log('Processing the image');\r\n    return tf.tidy(() => image.expandDims(0).toFloat());//.div(127).sub(1));\r\n  }\r\n\r\n  /**\r\n   * Computes the probabilities of the topK classes given logits by computing\r\n   * softmax to get probabilities and then sorting the probabilities.\r\n   * @param logits Tensor representing the logits from MobileNet.\r\n   * @param topK The number of top predictions to show.\r\n   */\r\n  getTopKClasses = async (values, topK) => {\r\n    const topClassesAndProbs = [];\r\n    //multiple classes\r\n    if(values.length > 1) {\r\n      //Stores CNN predictions for each class\r\n      const valuesAndIndices = [];\r\n      for (let i = 0; i < values.length; i++) {\r\n        valuesAndIndices.push({value: values[i], index: i});\r\n      }\r\n      //Sorts predictions\r\n      valuesAndIndices.sort((a, b) => {\r\n        return b.value - a.value;\r\n      });\r\n      //Stores topK predictions and class indices\r\n      const topkValues = new Float32Array(topK);\r\n      const topkIndices = new Int32Array(topK);\r\n      for (let i = 0; i < topK; i++) {\r\n        topkValues[i] = valuesAndIndices[i].value;\r\n        topkIndices[i] = valuesAndIndices[i].index;\r\n      }\r\n      const topClassesAndProbs = [];\r\n      for (let i = 0; i < topkIndices.length; i++) {\r\n        topClassesAndProbs.push({\r\n          className: MODEL_CLASSES[topkIndices[i]],\r\n          //Calculated probability\r\n          //probability: (topkValues[i] * 100).toFixed(2)\r\n          //Raw value from CNN\r\n          probability: (topkValues[i]).toFixed(5)\r\n        });\r\n      }\r\n\r\n    }\r\n    //single class\r\n    else {\r\n      //Stores binary prediction from CNN\r\n      var prediction = values[0];\r\n      //By default, assume prediction is inconclusive (0.5)\r\n      var idx = 5;\r\n      //Prediction is negative\r\n      if(prediction < 0.5) {\r\n        idx = 0;\r\n        prediction = (1-prediction)*100;\r\n      }\r\n      //Prediction is positive\r\n      else if (prediction > 0.5) {\r\n        idx = 4;\r\n        prediction = prediction*100;\r\n      }\r\n      topClassesAndProbs.push({\r\n       className: MODEL_CLASSES[idx],\r\n       //Calculated probability\r\n       //probability: (Math.abs(prediction - 0.5) * 200).toFixed(2)\r\n       //Raw value from CNN\r\n       probability: (prediction).toFixed(2)\r\n     });\r\n   }\r\n    //Returns predictions\r\n    return topClassesAndProbs;\r\n  }\r\n\r\n  handlePanelClick = event => {\r\n    this.setState({ photoSettingsOpen: !this.state.photoSettingsOpen });\r\n  }\r\n\r\n  handleFileChange = event => {\r\n    if (event.target.files && event.target.files.length > 0) {\r\n      this.setState({\r\n        file: URL.createObjectURL(event.target.files[0]),\r\n        filename: event.target.files[0].name\r\n      });\r\n    }\r\n  }\r\n\r\n  handleTabSelect = activeKey => {\r\n    switch(activeKey) {\r\n      case 'camera':\r\n        this.startWebcam();\r\n        break;\r\n      case 'localfile':\r\n        this.setState({filename: null, file: null});\r\n        this.stopWebcam();\r\n        break;\r\n      default:\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"Classify container\">\r\n\r\n      { !this.state.modelLoaded &&\r\n        <Fragment>\r\n          <Spinner animation=\"border\" role=\"status\">\r\n            <span className=\"sr-only\">Loading...</span>\r\n          </Spinner>\r\n          {' '}<span className=\"loading-model-text\">Loading Model</span>\r\n        </Fragment>\r\n      }\r\n\r\n      { this.state.modelLoaded &&\r\n        <Fragment>\r\n        <Button\r\n          onClick={this.handlePanelClick}\r\n          className=\"classify-panel-header\"\r\n          aria-controls=\"photo-selection-pane\"\r\n          aria-expanded={this.state.photoSettingsOpen}\r\n          >\r\n          Take or Select a Photo to Classify\r\n            <span className='panel-arrow'>\r\n            { this.state.photoSettingsOpen\r\n              ? <FaChevronDown />\r\n              : <FaChevronRight />\r\n            }\r\n            </span>\r\n          </Button>\r\n          <Collapse in={this.state.photoSettingsOpen}>\r\n            <div id=\"photo-selection-pane\">\r\n            { this.state.modelUpdateAvailable && this.state.showModelUpdateAlert &&\r\n                <Container>\r\n                  <Alert\r\n                    variant=\"info\"\r\n                    show={this.state.modelUpdateAvailable && this.state.showModelUpdateAlert}\r\n                    onClose={() => this.setState({ showModelUpdateAlert: false})}\r\n                    dismissible>\r\n                      An update for the <strong>{this.state.modelType}</strong> model is available.\r\n                      <div className=\"d-flex justify-content-center pt-1\">\r\n                        {!this.state.isDownloadingModel &&\r\n                          <Button onClick={this.updateModel}\r\n                                  variant=\"outline-info\">\r\n                            Update\r\n                          </Button>\r\n                        }\r\n                        {this.state.isDownloadingModel &&\r\n                          <div>\r\n                            <Spinner animation=\"border\" role=\"status\" size=\"sm\">\r\n                              <span className=\"sr-only\">Downloading...</span>\r\n                            </Spinner>\r\n                            {' '}<strong>Downloading...</strong>\r\n                          </div>\r\n                        }\r\n                      </div>\r\n                  </Alert>\r\n                </Container>\r\n              }\r\n              {this.state.showModelUpdateSuccess &&\r\n                <Container>\r\n                  <Alert variant=\"success\"\r\n                         onClose={() => this.setState({ showModelUpdateSuccess: false})}\r\n                         dismissible>\r\n                    The <strong>{this.state.modelType}</strong> model has been updated!\r\n                  </Alert>\r\n                </Container>\r\n              }\r\n            <Tabs defaultActiveKey=\"camera\" id=\"input-options\" onSelect={this.handleTabSelect}\r\n                  className=\"justify-content-center\">\r\n              <Tab eventKey=\"camera\" title=\"Take Photo\">\r\n                <div id=\"no-webcam\" ref=\"noWebcam\">\r\n                  <span className=\"camera-icon\"><FaCamera /></span>\r\n                  No camera found. <br />\r\n                  Please use a device with a camera, or upload an image instead.\r\n                </div>\r\n                <div className=\"webcam-box-outer\">\r\n                  <div className=\"webcam-box-inner\">\r\n                    <video ref=\"webcam\" autoPlay playsInline muted id=\"webcam\"\r\n                           width=\"448\" height=\"448\">\r\n                    </video>\r\n                  </div>\r\n                </div>\r\n                <div className=\"button-container\">\r\n                  <LoadButton\r\n                    variant=\"primary\"\r\n                    size=\"lg\"\r\n                    onClick={this.classifyWebcamImage}\r\n                    isLoading={this.state.isClassifying}\r\n                    text=\"Classify\"\r\n                    loadingText=\"Classifying...\"\r\n                  />\r\n                </div>\r\n              </Tab>\r\n              <Tab eventKey=\"localfile\" title=\"Select Local File\">\r\n                <Form.Group controlId=\"file\">\r\n                  <Form.Label>Select Image File</Form.Label><br />\r\n                  <Form.Label className=\"imagelabel\">\r\n                    {this.state.filename ? this.state.filename : 'Browse...'}\r\n                  </Form.Label>\r\n                  <Form.Control\r\n                    onChange={this.handleFileChange}\r\n                    type=\"file\"\r\n                    accept=\"image/*\"\r\n                    className=\"imagefile\" />\r\n                </Form.Group>\r\n                { this.state.file &&\r\n                  <Fragment>\r\n                    <div id=\"local-image\">\r\n                      <Cropper\r\n                        ref=\"cropper\"\r\n                        src={this.state.file}\r\n                        style={{height: 400, width: '100%'}}\r\n                        guides={true}\r\n                        aspectRatio={1 / 1}\r\n                        viewMode={2}\r\n                      />\r\n                    </div>\r\n                    <div className=\"button-container\">\r\n                      <LoadButton\r\n                        variant=\"primary\"\r\n                        size=\"lg\"\r\n                        disabled={!this.state.filename}\r\n                        onClick={this.classifyLocalImage}\r\n                        isLoading={this.state.isClassifying}\r\n                        text=\"Classify\"\r\n                        loadingText=\"Classifying...\"\r\n                      />\r\n                    </div>\r\n                  </Fragment>\r\n                }\r\n              </Tab>\r\n            </Tabs>\r\n            </div>\r\n          </Collapse>\r\n          { this.state.predictions.length > 0 &&\r\n            <div className=\"classification-results\">\r\n              <h3>Predictions</h3>\r\n              <canvas ref=\"canvas\" width={CANVAS_SIZE} height={CANVAS_SIZE}></canvas>\r\n              <br />\r\n              <ListGroup>\r\n              {this.state.predictions.map((category) => {\r\n                  return (\r\n                    <ListGroup.Item key={category.className}>\r\n                      <strong>{category.className}</strong> {category.probability}%</ListGroup.Item>\r\n                  );\r\n              })}\r\n              </ListGroup>\r\n            </div>\r\n          }\r\n          </Fragment>\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from 'react';\r\nimport './Instructions.css';\r\n\r\n/**\r\n * Class to handle the rendering of the Home page.\r\n * @extends React.Component\r\n */\r\nexport default class Home extends Component {\r\n  render() {\r\n    return (\r\n      <div className=\"Instructions container\">\r\n        <h1>Instructions</h1>\r\n        <p>\r\n          Steps to upload fecal sample image for STH diagnosis:\r\n        <br />\r\n        <br />\r\n          1. Go to the \"Classify\" page\r\n        <br />\r\n          2. Click on \"Select Local File\"\r\n        <br />\r\n          3. Click on \"Browse\" under Select Image File.\r\n        <br />\r\n          4. Select the image file you want to process.\r\n        <br />\r\n          5. Click on \"Classify\"\r\n        <br />\r\n        <br />\r\n          The webpage will now output an STH diagnosis.\r\n        </p>\r\n        <h1> FAQS </h1>\r\n        <p>\r\n          <b>\r\n            What is this webpage for?\r\n            </b>\r\n            <br />\r\n            Our project aims to reduce mass drug administration to treat Soil Transmitted Helminth\r\n            infections. Over 1 billion people are affected by these parasitic diseases globally,\r\n            and the current solution is to administer packaged drugs to entire communities without\r\n            prior diagnosis because that requires time and resources such as trained microscopists\r\n            which aren’t readily available. We’ve developed a convolutional neural network that\r\n            detects soil transmitted helminths in microscopic images of fecal samples that works in\r\n            the backend of this progressive web page. This webpage only requires internet on the\r\n            first use and for updates, and is stored in the user’s browser cache for future offline\r\n            uses\r\n        <br />\r\n        <br />\r\n          <b> How to save this webpage in my browser?\r\n          </b>\r\n          <br />\r\n            In Chrome, click on the three dots at the top left of the page. You can either:\r\n          <br /> 1) Select \"Bookmarks\" and select \"Bookmark this tab\" to bookmark this page on your\r\n           browser.\r\n          <br /> 2) Select \"More Tools\" and select \"Save Page as\" to save this page locally on your\r\n           computer.\r\n          <br /> 3) Select \"More Tools\" and select \"Create shortcut\" to create a shortcut locally\r\n          on your computer.\r\n        <br />\r\n        <br />\r\n          <b> How accurate is the diagnosis?\r\n          </b>\r\n        <br />\r\n        * Accuracy: 91.82%\r\n        <br />\r\n        * Sensitivity: 73.33%\r\n        <br />\r\n        * False negative rate: 2.3%\r\n        <br />\r\n        * Specificity: 96.55%\r\n        <br />\r\n        <br />\r\n          <b> Why do we need diagnosis when mass drug administration exists?\r\n          </b>\r\n        <br />\r\n        Since individual diagnosis by trained microscopist is currently not a feasible option,\r\n        most tropical illnesses are treated with the distribution of mass drug delivery,\r\n        which is a cheap way of eliminating multiple illnesses that share the same geographic\r\n        region. However, this method is wasteful and often unpleasant for the population receiving\r\n        the distributed medicine due to various non-lethal side effects such as nausea, vomiting,\r\n        etc. Our goal is to provide the ability for easy individual diagnosis of these parasitic\r\n        diseases to avoid administering drugs to uninfected people.\r\n        <br />\r\n        <br />\r\n          <b> What are the effects of Soil Transmitted Helminth infections?\r\n          </b>\r\n        <br />\r\n        The World Health Organization (WHO) lists the effects of STH infection as the following:\r\n        <br />\r\n        <br />\r\n        * \"The worms feed on host tissues, including blood, which leads to a loss of iron and\r\n         protein.\"\r\n        <br />\r\n        * \"Hookworms in addition cause chronic intestinal blood loss that can result in anaemia.\"\r\n        <br />\r\n        * \"The worms increase malabsorption of nutrients. In addition, roundworm may possibly\r\n        compete\r\n        for vitamin A in the intestine.\"\r\n        <br />\r\n        * \"Some soil-transmitted helminths also cause loss of appetite and, therefore, a reduction\r\n         of nutritional intake and physical fitness.\"\r\n        <br />\r\n        <br />\r\n          <b> Where can I learn more about Soil Transmitted Helminths?\r\n          </b>\r\n        <br />\r\n          Here are some links to help supplement your knowledge of Soil Transmitted Helminths:\r\n        <br />\r\n        <a href=\r\n        \"https://www.who.int/news-room/fact-sheets/detail/soil-transmitted-helminth-infections\"\r\n        > * WHO Soil Transmitted Helminth\r\n        Infections</a>\r\n        <br />\r\n        <a href=\"https://www.neglecteddiseases.gov/usaid-targeted-\r\n        diseases/soil-transmitted-helminths\"> * USAID Neglected Diseases</a>\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n}","import React from 'react';\r\nimport './NotFound.css';\r\n\r\n/**\r\n * This is rendered when a route is not found (404).\r\n */\r\nexport default () =>\r\n  <div className=\"NotFound\">\r\n    <h1>404</h1>\r\n    <h3>The page you were looking for is not here.</h3>\r\n    <a href=\"/\">Go Home</a>\r\n  </div>;\r\n","import React from 'react';\r\nimport { Route, Switch } from 'react-router-dom';\r\nimport About from './pages/About';\r\nimport Classify from './pages/Classify';\r\nimport Instructions from './pages/Instructions';\r\nimport NotFound from './pages/NotFound';\r\n\r\nexport default ({ childProps }) =>\r\n  <Switch>\r\n    <Route path=\"/ewh-portable-microscopy/classify\" exact component={Classify} props={childProps} />\r\n    <Route path=\"/ewh-portable-microscopy\" exact component={Instructions} props={childProps} />\r\n    <Route path=\"/ewh-portable-microscopy/about\" exact component={About} props={childProps} />\r\n    <Route component={NotFound} />\r\n  </Switch>;\r\n","import { PropTypes } from 'prop-types';\r\nimport React, { Component } from 'react';\r\nimport { Link, withRouter } from 'react-router-dom';\r\nimport { Container, Nav, Navbar } from 'react-bootstrap';\r\nimport AlertDismissable from './components/AlertDismissable';\r\nimport Routes from './Routes';\r\nimport './App.css';\r\n\r\n\r\nclass App extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    const reloadMsg = `\r\n      New content is available.<br />\r\n      Please <a href='javascript:location.reload();'>reload</a>.<br />\r\n      <small>If reloading doesn't work, close all tabs/windows of this web application,\r\n      and then reopen the application.</small>\r\n    `;\r\n    this.state = {\r\n      showUpdateAlert: true,\r\n      reloadMsg: reloadMsg\r\n    };\r\n  }\r\n\r\n  dismissUpdateAlert = event => {\r\n    this.setState({ showUpdateAlert: false });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n        <div className=\"App\">\r\n          <Container>\r\n            <Navbar collapseOnSelect className=\"app-nav-bar\" variant=\"dark\" expand=\"lg\">\r\n              <Navbar.Brand href=\"/ewh-portable-microscopy\">WebClassify</Navbar.Brand>\r\n              <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\r\n              <Navbar.Collapse id=\"basic-navbar-nav\">\r\n                <Nav className=\"\">\r\n                  <Link className=\"nav-link\" to=\"/ewh-portable-microscopy/classify\">Classify</Link>\r\n                  <Link className=\"nav-link\" to=\"/ewh-portable-microscopy\">Instructions</Link>\r\n                  <Link className=\"nav-link\" to=\"/ewh-portable-microscopy/about\">About</Link>\r\n                </Nav>\r\n              </Navbar.Collapse>\r\n            </Navbar>\r\n            { this.props.updateAvailable && this.state.showUpdateAlert &&\r\n              <div style={{paddingTop: '10px'}}>\r\n                <AlertDismissable\r\n                  title=\"\"\r\n                  variant=\"info\"\r\n                  message={this.state.reloadMsg}\r\n                  show={this.props.updateAvailable && this.state.showUpdateAlert}\r\n                  onClose={this.dismissUpdateAlert} />\r\n              </div>\r\n            }\r\n          </Container>\r\n          <Container>\r\n            <Routes />\r\n          </Container>\r\n        </div>\r\n    );\r\n  }\r\n}\r\n\r\nApp.propTypes = {\r\n  updateAvailable: PropTypes.bool.isRequired,\r\n};\r\n\r\nexport default withRouter(App);\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      // A new service worker has previously finished installing, and is now waiting.\r\n      if (registration.waiting && registration.active) {\r\n        newerSwAvailable(registration.waiting);\r\n      }\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              newerSwAvailable(installingWorker);\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n      function newerSwAvailable(sw){\r\n        // At this point, the updated precached content has been fetched,\r\n        // but the previous service worker will still serve the older\r\n        // content until all client tabs are closed.\r\n        console.log(\r\n          'New content is available and will be used when all ' +\r\n            'tabs for this page are closed. See http://bit.ly/CRA2-PWA.'\r\n        );\r\n        if (config && config.onUpdate) {\r\n          config.onUpdate(registration, sw);\r\n        }\r\n      }\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React, { Component } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { BrowserRouter as Router } from 'react-router-dom';\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\n\r\nclass Index extends Component {\r\n  state = {\r\n    contentCached: false,\r\n    updateAvailable: false,\r\n  };\r\n\r\n  componentDidMount() {\r\n    const config = {\r\n      onUpdate: this.handleUpdate,\r\n    };\r\n\r\n    // If you want your app to work offline and load faster, you can change\r\n    // unregister() to register() below. Note this comes with some pitfalls.\r\n    // Learn more about service workers: https://bit.ly/CRA-PWA\r\n    serviceWorker.register(config);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Router>\r\n        <App updateAvailable={this.state.updateAvailable} />\r\n      </Router>\r\n    );\r\n  }\r\n\r\n  handleUpdate = (registration) => {\r\n    const waitingServiceWorker = registration.waiting;\r\n\r\n    if (waitingServiceWorker) {\r\n      waitingServiceWorker.postMessage({ type: 'SKIP_WAITING' });\r\n    }\r\n    this.setState({ updateAvailable: true});\r\n  }\r\n}\r\n\r\nReactDOM.render(<Index />, document.getElementById('root'));\r\n"],"sourceRoot":""}